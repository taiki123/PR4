<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
     <!-- BootstrapのCSS読み込み -->
   <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">

   <link href="style.css" rel="stylesheet">
    <!-- jQuery読み込み -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <!-- BootstrapのJS読み込み -->
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script>

    //--------------変数宣言--------------
    var hot_shop_id = localStorage.getItem('data');  //店ID
    var hot_rep = ""; //ホットペッパーget用変数
    var hot_api_key = ""; //ホットペッパーapi_key
    var hot_get = ""; //ホットペッパーデータ格納用
    var keyid = ""; //ぐるなびapi_key
    var g_rep = ""; //ぐるなびget用変数
    var g_get = ""; //ぐるなびデータ格納用
    var params = "" ; //　ぐるなびget設定変数
    var showResult = ""; //
    //----------------------------------

    if (hot_shop_id != null) {  //店IDの空白判定
      hot();　//ホットペッパーデータ取得関数

      function hot() {
//        console.log("hot");
         hot_api_key="10f59688fc27c9e0";
         hot_rep =  'https://webservice.recruit.co.jp/hotpepper/gourmet/v1/?key='+hot_api_key+'&id='+hot_shop_id+'&range=1&order=4&count=100&format=jsonp';
        $.ajax({
          type:'GET',
          url: hot_rep,
          dataType: 'jsonp',
        success: function (data) {
          hot_get = data;
          console.log(data);
          gurunabi();　//ぐるなびデータ取得関数
        }
        });
      }
    }else {
      console.log("失敗");
    }

      showResult = function(result){
     if ( result.total_hit_count > 0 ) {
       console.log("match成功");
         console.log(result.total_hit_count);
           g_get = result;
       console.log(g_get);
     } else {
       alert( '検索結果が見つかりませんでした。' );
     }
   }

   function gurunabi () {

     g_rep = 'https://api.gnavi.co.jp/RestSearchAPI/20150630/?callback=?';
     console.log(hot_get.results.shop[0].address);
     console.log(hot_get.results.shop[0].name);
       params = {
       keyid: '06ebf6157586406aeebdc819d9ff3998',
       format: 'json',
       address:hot_get.results.shop[0].address,
     };

     $.getJSON(g_rep, params, function(result){
       console.log("guru");
       showResult(result);
     });
   }

/*
function hiraToKana(str) {
    return str.replace(/[\u3041-\u3096]/g, function(match) {
        var chr = match.charCodeAt(0) + 0x60;
        return String.fromCharCode(chr);
    });
}
*/
/*
function check(txt)
{
	var　data1 = txt.match(/^[0-9-]{6,9}$|^[0-9-]{12}$/);
	var data2 = txt.match(/^\d{1,4}-\d{4}$|^\d{2,5}-\d{1,4}-\d{4}$/);
  if (!data1 && !data2) {
    console.log("不正");
    console.log(data1);
    console.log(data2);
    return String.fromCharCode(data1);
  }else {
    console.log("正規表現");
    console.log(data1);
    console.log(data2);
    return String.fromCharCode(data1);
  }
}
*/
    </script>
  </head>
  <body>

<nav class="navbar navbar-default">
  <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#gnavi">
        <span class="sr-only">メニュー</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>

    <div id="gnavi" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li><a href="index.html">top</a></li>
        <li><a href="login.html">login</a></li>
      </ul>
    </div>
</nav>

<h1>お店の詳細ページ</h1>
<div class="container">
  　<div class="row">
  　  <div class="hot_contents col-xs-12">

  　  </div>
  　</div>
</div>
  </body>
</html>
